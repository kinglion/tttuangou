<!--{template @admin/header}--> <script type="text/javascript" src="./static/js/jquery.js"></script> <form method="post" action="admin.php?mod=tttuangou&code=mailcron&op=dels"> <table cellspacing="1" cellpadding="4" width="100%" class="tableborder"> <tr class="header"> <td>åœ¨çº¿é‚®ä»¶å‘é€?/td> </tr> <tr> <td>
è¿™é‡Œå¯ä»¥å¿«é€Ÿçš„ç¾¤å‘é‚®ä»¶ï¼Œå‘é€æœŸé—´è¯·ä¸è¦å…³é—­æµè§ˆå™¨ã€?br/> <b>ç‰¹åˆ«æç¤ºï¼?/b><br/>
å¦‚æœä½ ä½¿ç”¨çš„é‚®ä»¶æœåŠ¡å™¨æœ‰é™åˆ¶ï¼Œä¸å¯ä»¥è¿ç»­çš„å‘é€é‚®ä»¶ï¼Œè¯·å°½é‡å‡å°‘ä½¿ç”¨æœ¬åŠŸèƒ½çš„æ—¶é—´ã€?</td> </tr> <tr> <td> <div style="width:600px;height:10px;border:1px solid #000;"> <div id="cr_bar" style="width:0px;height:10px;background:#000;"></div> </div>
[ <font id="cr_sends">0</font> / {$cronLength} ] &gt;&gt;&gt; <font id="cr_perc">0</font> %
</td> </tr> <tr> <td> <input id="cr_control" type="button" value="å¼€å§? class="button" /> </td> </tr> </table> </form> <script type="text/javascript">
var gf_url = 'admin.php?mod=tttuangou&code=mailcrondo&op=run';
var gf_runs = false;
var gf_sends = 0;
var gf_total = {$cronLength};
$(document).ready(function(){
$('#cr_control').bind('click', function(){
if (!gf_runs)
{
gf_runs = true;
$('#cr_control').val('æš‚åœ');
mailCronRun();
}
else
{
gf_runs = false;
$('#cr_control').val('ç»§ç»­');
}
});
});
function mailCronRun()
{
if (!gf_runs) return;
$.get(gf_url, function(data){
var sends = parseInt(data);
if (sends>0)
{
gf_sends += sends;
if (gf_sends >= gf_total)
{
alert('å‘é€å®Œæˆï¼');
gf_runs = false;
gf_sends = gf_total;
mailCronDisplayer();
$('#cr_control').val('å®Œæˆ');
$('#cr_control').unbind('click');
}
else
{
mailCronDisplayer();
setTimeout(mailCronRun, 300);
}
}
else
{
alert('æœåŠ¡å™¨å‡ºé”™ï¼š'+"\n"+data);
}
});
}
function mailCronDisplayer()
{
var prc = (gf_sends/gf_total).toFixed(2);
var cr_bar = Math.round(prc*600);
var cr_perc = Math.round(prc*100);
$('#cr_bar').css('width', cr_bar+'px');
$('#cr_sends').text(gf_sends);
$('#cr_perc').text(cr_perc);
}
</script>
{template @admin/footer}